<!DOCTYPE html>
<html>
    <head>
        <title>Numbergame</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="/socket.io/socket.io.js"></script>
<!--        <script src="bootstrap/bootstrap.min.css" ></script>-->
        <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" integrity="sha384-HzUaiJdCTIY/RL2vDPRGdEQHHahjzwoJJzGUkYjHVzTwXFQ2QN/nVgX7tzoMW3Ov" crossorigin="anonymous">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <style>
            ul#users {
                list-style-type: none;
            }
            li.game {
                display:none;
            }
            .nickset {
                display:block !important;
            } 
            .nickoff {
                display:none;
            }
            li.login_page {
                display: block;
            }
        </style>
        <script type="text/javascript">
            // create client socket
            var socket = io.connect("http://localhost:3010");
            
            // client socket to output guesses
            socket.on("number", function (data) {
                document.getElementById("number").innerHTML = ("<br>" +
                        data + document.getElementById("number").innerHTML);
            });
            
            // alert message
            socket.on('alert', function (msg) {
                alert('Game over! ' + msg);
            });
            
            // welcome message
            socket.on('welcome', function (data) {
                console.log(data);
                welcome.innerHTML = "Welcome to the game <strong>" + data.name + "</strong>";
            });
            
            // user count
            socket.on('user_count', function (data) {
                console.log(data);
                user_count.innerHTML = "<strong>" + data + "</strong> players online";
            });
            
            // list of players
            socket.on('users', function (data) {
                users.innerHTML = "<h3><strong>Playernames: </strong></h3>"
                        + "<li>" + data.users + "</li>";
            });
            
            // function that gets nickname value and sends
            // it to server
           function getNickname() {
               // stores the input value to a variable and checks if it is empty
                var nickname = document.getElementById("nickname_input").value;
                if(nickname === "") {
                    alert('Please enter your nickname');
                } else {
                    
                // if nickname was submitted 
                // jquery removes login page
                // and shows the actual game
                $(document).ready(function(){

                $(".login_page").remove();
                $(".game").addClass("nickset");
                });
                
                //emit the nickname to server
                socket.emit("nickname_to_server", {message: nickname});
            }
           }

            function sendMessage() {
                //take the message_imput value to a variable
                var contents = document.getElementById("message_input").value;
                // emit the contents to server
                socket.emit("message_to_server", {message: contents});
            }
        </script>
    </head>
    <body>
        <div class="container">
        <ul class="pages">
            <li class="game">
                <div id="welcome"></div><br />
                <div id="user_count"></div>
                <ul id="users"></ul>
                <input type="number" id="message_input"/>		
                <button class="btn btn-primary" onclick="sendMessage()">Guess</button>
                <p>Numbers guessed</p>
                <div id="chat"></div>
                <div id="number"></div>
            </li>
            <li class="login_page">
                <div class="form">
                    <h3 class="title">What's your nickname?</h3>
                    <input id="nickname_input" class="usernameInput" type="text" maxlength="25" />
                    <button onclick="getNickname()">Submit</button>
                </div>
            </li>
        </ul>
        </div>    
    </body>
</html>
